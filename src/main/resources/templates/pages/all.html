<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.0.2/dist/lux/bootstrap.min.css">

    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/28e8f88d79.js" crossorigin="anonymous"></script>

    <!-- Links -->
    <link href="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-star-rating@4.1.0/css/star-rating.css" media="all"
          rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" th:href="@{/css/star-rating.min.css}">
    <link href="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-star-rating@4.1.0/themes/krajee-fas/theme.css"
          media="all" rel="stylesheet" type="text/css"/>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-star-rating@4.1.0/js/star-rating.js"
            type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-star-rating@4.1.0/themes/krajee-fas/theme.js"></script>

    <!-- Style -->
    <link rel="stylesheet" th:href="@{/css/all.css}">

    <title>Настройки</title>
</head>

<body>
<div sec:authorize="hasRole('ROLE_ADMIN')">
    <div th:replace="~{/fragments/navbar.html :: header-admin}"/>
</div>
<div sec:authorize="hasRole('ROLE_USER')">
    <div th:replace="~{/fragments/navbar.html :: header-lk}"/>
</div>

<fieldset>
    <div class="form-group" id="main-form">
        <div class="row justify-content-around">
            <div class="container col-5 border-5 shadow-lg">
                <label class="form-label mt-4" id="label-lk" th:text="${user.fullName}">Личный кабинет</label>
                <input class="seller-rating rating-stars" th:value="*{user.seller_rating}"
                       dir="ltr" data-size="sm"
                       data-show-clear=false data-show-caption=true data-display-only=true>
                <!--<img th:object="${user}" style="border-radius: 50%; width: 64px; margin-right: 15px;" th:src="@{${user.imagesPath}}"/>-->
                <form action="#"
                      th:action="@{/lk/all/update}"
                      th:object="${user}"
                      method="post"
                      enctype="multipart/form-data">

                    <input type="hidden" th:field="${user.userId}">
                    <input type="hidden" th:field="${user.balance}">
                    <input type="hidden" th:field="${user.confirmed}">
                    <input type="hidden" th:field="${user.seller_rating}">
                    <input type="hidden" th:field="${user.buyers_rating}">
                    <input type="hidden" th:field="${user.date_of_birth}">
                    <input type="hidden" th:field="${user.images}">
                    <input type="hidden" th:field="${user.roles}">
                    <input type="hidden" th:field="${user.authorities}">


                    <div class="form-group">
                        <label for="exampleInputFirstName" class="form-label mt-4">Имя</label>
                        <input type="text" class="form-control" id="exampleInputFirstName"
                               aria-describedby="firstNameHelp" th:field="*{first_name}">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputLastName" class="form-label mt-4">Фамилия</label>
                        <input type="text" class="form-control" id="exampleInputLastName"
                               aria-describedby="lastNameHelp" th:field="*{last_name}">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputPhoneNumber" class="form-label mt-4">Номер телефона</label>
                        <input type="text" class="form-control" id="exampleInputPhoneNumber"
                               aria-describedby="phoneNumberHelp" th:field="*{phone_number}">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputEmail1" class="form-label mt-4">E-mail</label>
                        <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp"
                               th:field="*{email}">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputEmail1" class="form-label mt-4">Пароль</label>
                        <input type="password" class="form-control" id="exampleInputPassword1"
                               aria-describedby="passwordHelp" placeholder="Оставьте пустым, если не меняете пароль"
                               th:field="*{password}">
                    </div>
                    <div class="form-group">
                        <!--<img class="img-thumbnail" th:src="@{${user.imagesPath}}"/>-->
                        <label for="image" class="form-label mt-4">Загрузить фото</label>
                        <input class="form-control" type="file" id="image" name="image" title=" "
                               accept="image/png, image/jpeg"/>
                    </div>
                    <div>
                        <button type="submit" class="btn btn-primary" id="btn-update">Редактировать</button>
                    </div>
                </form>
            </div>

            <!--<div class="card  " style="background-color:#f3f3f3;">
                <div class="card-body">
                    <h5 class="card-title">Card title</h5>
                    <p class="card-text">
                        Some quick example text to build on the card title and make up the bulk of the
                        card's content.
                    </p>


                </div>
            </div>-->

            <div class="container col-5 border-5 shadow-lg">
                <label class="form-label mt-4" id="label-balance">Баланс</label>
                <div>
                    <p th:text="*{user.balance}" style="size: 20px">Balance</p>
                    <form action="#"
                          th:action="@{/lk/addBalance}"
                          th:object="${user}"
                          method="post">
                        <input type="hidden" th:field="*{userId}">
                        <input type="hidden" th:field="*{first_name}">
                        <input type="hidden" th:field="*{last_name}">
                        <input type="hidden" th:field="*{phone_number}">
                        <input type="hidden" th:field="*{email}">
                        <input type="hidden" th:field="*{date_of_birth}">
                        <input type="hidden" th:field="*{seller_rating}">
                        <input type="hidden" th:field="*{buyers_rating}">
                        <input type="hidden" th:field="*{confirmed}">
                        <input type="hidden" th:field="*{balance}">
                        <input type="hidden" th:field="*{password}">

                        <div class="form-group">
                            <div class="col">
                                <hr>
                            </div>
                            <div class="input-group mb-3">
                                <span class="input-group-text">₽</span>
                                <input type="text" class="form-control" placeholder="Введите сумму"
                                       th:name="money" aria-label="Количество">
                                <span class="input-group-text">.00</span>
                            </div>
                            <div class="col">
                                <button type="submit" class="btn btn-primary" id="btn-balance">Пополнить</button>
                            </div>
                        </div>

                    </form>
                </div>
                <div ><!--sec:authorize="!hasRole('ROLE_SELLER')&&!hasRole('ROLE_ADMIN')"-->
                    <form th:object="${user}"
                          th:action="@{/lk/get/role_seller/{id}(id=${user.userId})}"
                          method="GET">

                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#collapseTwo" aria-expanded="true"
                                        aria-controls="collapseTwo">
                                    Получить возможности продавца
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse show"
                                 aria-labelledby="headingTwo" data-bs-parent="#accordionExample" style="">
                                <div class="accordion-body">
                                    <table class="table table-hover">
                                        <thead>
                                        <tr>
                                            <th scope="col">Возможности</th>
                                            <th scope="col">Обычный пользователь</th>
                                            <th scope="col">Продавец</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <th scope="row">Просматривать объявления</th>
                                            <td>*</td>
                                            <td>*</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Выкладывать объявления</th>
                                            <td>-</td>
                                            <td>*</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Просматривать статистику</th>
                                            <td>-</td>
                                            <td>*</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                    <p>Роль продавца стоит 100 рублей.</p>

                                    <div class="col">
                                        <button class="btn btn-primary" id="btn-buy" onclick="this.parentNode.submit()">Получить возможности продавца</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</fieldset>

<script>
    $(document).ready(function () {
        $('.review').rating({
            theme: 'krajee-fas',
        });

        $('.seller-rating').rating({
            theme: 'krajee-fas',
            step: 0.1
        });
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

</body>
</html>
